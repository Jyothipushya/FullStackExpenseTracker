<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BudgetWise | Create Saving Goal</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .goal-setup-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .form-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: #9b59b6;
            box-shadow: 0 0 0 2px rgba(155, 89, 182, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            text-decoration: none;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #9b59b6;
            color: white;
        }

        .btn-primary:hover {
            background: #8e44ad;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1.5rem;
        }

        .alert-success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #2ecc71;
        }

        .alert-error {
            background: #f8d7da;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .amount-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .amount-input-group span {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23333' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
            padding-right: 2.5rem;
        }
    </style>
</head>
<body>
<div class="dashboard-container">
    <!-- Sidebar (same as dashboard.html) -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo"><i class="fas fa-chart-line"></i><h2>Budget<span>Wise</span></h2></div>
        </div>
        <div class="user-profile">
            <div class="avatar"><i class="fas fa-user-circle"></i></div>
            <div class="user-info">
                <h4 th:text="${userName}">Jyothi Pushya</h4>
                <p>Create Goal</p>
            </div>
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li><a href="/dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a></li>
                <li><a href="/expenses"><i class="fas fa-wallet"></i><span>Expenses</span></a></li>
                <li><a href="/budgets"><i class="fas fa-chart-pie"></i><span>Budget</span></a></li>
                <li><a href="/goals/dashboard"><i class="fas fa-bullseye"></i><span>Saving Goals</span></a></li>
                <li><a href="/budgets/budget-and-goals"><i class="fas fa-exchange-alt"></i><span>Budget & Goals</span></a></li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="goal-setup-container">
            <!-- Header -->
            <div style="margin-bottom: 2rem;">
                <h1>Create Saving Goal</h1>
                <p>Plan for your financial future</p>
            </div>

            <!-- Success/Error Messages -->
            <div th:if="${success}" class="alert alert-success">
                <i class="fas fa-check-circle"></i>
                <span th:text="${success}"></span>
            </div>
            <div th:if="${error}" class="alert alert-error">
                <i class="fas fa-exclamation-circle"></i>
                <span th:text="${error}"></span>
            </div>

            <!-- Goal Form -->
            <!-- Goal Form -->
            <div class="form-card">
                <form th:action="@{/goals/save}" method="post">
                    <!-- Goal Name -->
                    <div class="form-group">
                        <label for="name">Goal Name *</label>
                        <input type="text" id="name" name="name" class="form-control"
                               placeholder="e.g., Europe Vacation, New Car Down Payment" required>
                    </div>

                    <!-- Category -->
                    <div class="form-group">
                        <label for="category">Category *</label>
                        <select id="category" name="category" class="form-control" required>
                            <option value="">Select a category</option>
                            <option th:each="cat : ${categories}" th:value="${cat}" th:text="${cat}"></option>
                        </select>
                    </div>

                    <!-- Amounts -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="targetAmount">Target Amount *</label>
                            <div class="amount-input-group">
                                <span>짜</span>
                                <input type="number" id="targetAmount" name="targetAmount" class="form-control"
                                       placeholder="e.g., 300000" min="100" step="100" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="savedAmount">Already Saved</label>
                            <div class="amount-input-group">
                                <span>짜</span>
                                <input type="number" id="savedAmount" name="savedAmount" class="form-control"
                                       placeholder="e.g., 50000" min="0" step="100">
                            </div>
                        </div>
                    </div>

                    <!-- Target Date -->
                    <div class="form-group">
                        <label for="targetDate">Target Date *</label>
                        <input type="date" id="targetDate" name="targetDate" class="form-control" required>
                    </div>

                    <!-- Priority -->
                    <div class="form-group">
                        <label for="priority">Priority *</label>
                        <select id="priority" name="priority" class="form-control" required>
                            <option value="HIGH">High Priority</option>
                            <option value="MEDIUM" selected>Medium Priority</option>
                            <option value="LOW">Low Priority</option>
                        </select>
                    </div>

                    <!-- Monthly Contribution -->
                    <div class="form-group">
                        <label for="monthlyContribution">Monthly Contribution (Optional)</label>
                        <div class="amount-input-group">
                            <span>짜</span>
                            <input type="number" id="monthlyContribution" name="monthlyContribution" class="form-control"
                                   placeholder="e.g., 5000" min="0" step="100">
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <a href="/goals/dashboard" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-check"></i> Create Goal
                        </button>
                    </div>
                </form>
            </div>
<script>
    // Auto-calculate monthly contribution suggestion
    document.addEventListener('DOMContentLoaded', function() {
        const targetAmountInput = document.getElementById('targetAmount');
        const targetDateInput = document.getElementById('targetDate');
        const monthlyInput = document.getElementById('monthlyContribution');

        function calculateMonthlySuggestion() {
            const targetAmount = parseFloat(targetAmountInput.value);
            const targetDate = targetDateInput.value;

            if (targetAmount && targetDate) {
                const today = new Date();
                const target = new Date(targetDate);

                // Calculate months difference
                const monthsDiff = (target.getFullYear() - today.getFullYear()) * 12 +
                                   (target.getMonth() - today.getMonth());

                if (monthsDiff > 0) {
                    const suggestion = Math.ceil(targetAmount / monthsDiff);
                    monthlyInput.placeholder = 'Suggested: 짜' + suggestion.toLocaleString();
                }
            }
        }

        // Calculate on input change
        targetAmountInput.addEventListener('input', calculateMonthlySuggestion);
        targetDateInput.addEventListener('change', calculateMonthlySuggestion);
    });
</script>
</body>
</html>